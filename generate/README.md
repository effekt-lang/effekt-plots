# Generators

These bash scripts generate the `.json` data files in `../data`. You can
generate all data files by running `./main.sh`.

## Descriptions

The general concept is based on *producers* and *consumers* of data. For
the exact interactions read `main.sh`.

-   Generators
    -   `benchmarks.sh`: Measures the (phase-)time for selected
        benchmarks. By using `gnutime`, it also measures CPU and memory
        usage of all benchmarks in the benchmark config. *(writes data
        to `effekt/`)*
    -   `reference.sh`: Measures the benchmarks in the benchmark config
        in comparison with reference implementations using Hyperfine.
        *(writes data to `effekt/`)*
    -   `build.sh`: Builds and installs `effekt`. It also measures the
        time it took. *(writes data to stdout)*
    -   `cloc.sh`: Counts the lines of code in the `../effekt/`
        repository using `cloc`. *(writes data to stdout)*
-   Combiners
    -   `backends.sh`: Combines the generated benchmark data (in
        `effekt/`) to JSON grouped by backends. *(writes data to
        stdout)*
    -   `metrics.sh`: Combines the time, CPU and memory usage benchmark
        data (in `effekt/`) to a single JSON. *(writes data to stdout)*
    -   `phases.sh`: Combines the files generated by Effekt's
        `--time json` flag into a single JSON. *(writes data to stdout)*
-   Final
    -   `append.sh`: Appends new data (stdin) to existing `.json` files.
        It also adds a `meta` section that annotates the current commit
        and date. *(writes data to `data/`)*
